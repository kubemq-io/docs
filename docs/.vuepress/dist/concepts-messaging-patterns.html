<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Messaging Patterns | KubeMQ Documentation</title>
    <meta name="description" content="Message broker  for containers and Kubernetes">
    <link>
  <undefined></undefined>
    
    <link rel="preload" href="/assets/css/0.styles.4f59bb1b.css" as="style"><link rel="preload" href="/assets/js/app.d314ca50.js" as="script"><link rel="preload" href="/assets/js/5.5dd74b51.js" as="script"><link rel="prefetch" href="/assets/js/10.9278a2da.js"><link rel="prefetch" href="/assets/js/11.8a45635c.js"><link rel="prefetch" href="/assets/js/12.36a7201f.js"><link rel="prefetch" href="/assets/js/13.17a2c893.js"><link rel="prefetch" href="/assets/js/14.0f15f5c3.js"><link rel="prefetch" href="/assets/js/15.bc4e172c.js"><link rel="prefetch" href="/assets/js/16.10faa2b8.js"><link rel="prefetch" href="/assets/js/17.8cca37a8.js"><link rel="prefetch" href="/assets/js/18.ef144743.js"><link rel="prefetch" href="/assets/js/19.4887466d.js"><link rel="prefetch" href="/assets/js/2.102c67b8.js"><link rel="prefetch" href="/assets/js/20.cef1241a.js"><link rel="prefetch" href="/assets/js/21.13bdc53b.js"><link rel="prefetch" href="/assets/js/22.0d59d5ba.js"><link rel="prefetch" href="/assets/js/23.b050b19c.js"><link rel="prefetch" href="/assets/js/3.5930a1b1.js"><link rel="prefetch" href="/assets/js/4.95403ea9.js"><link rel="prefetch" href="/assets/js/6.4a645a9f.js"><link rel="prefetch" href="/assets/js/7.8d2f591c.js"><link rel="prefetch" href="/assets/js/8.a95765b8.js"><link rel="prefetch" href="/assets/js/9.b7004bd1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4f59bb1b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/kubemq-logo.png" alt="KubeMQ Documentation" class="logo"> <span class="site-name can-hide">KubeMQ Documentation</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Home</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Concepts</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/concepts-terminology.html" class="sidebar-link">Terminology</a></li><li><a href="/concepts-messaging-patterns.html" class="active sidebar-link">Messaging Patterns</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/concepts-messaging-patterns.html#events" class="sidebar-link">Events</a></li><li class="sidebar-sub-header"><a href="/concepts-messaging-patterns.html#events-store" class="sidebar-link">Events Store</a></li><li class="sidebar-sub-header"><a href="/concepts-messaging-patterns.html#commands" class="sidebar-link">Commands</a></li><li class="sidebar-sub-header"><a href="/concepts-messaging-patterns.html#queries" class="sidebar-link">Queries</a></li><li class="sidebar-sub-header"><a href="/concepts-messaging-patterns.html#commands-vs-queries" class="sidebar-link">Commands vs. Queries</a></li></ul></li><li><a href="/concepts-endpoints.html" class="sidebar-link">Endpoints</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Configuration</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Reference</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="messaging-patterns">Messaging Patterns</h1> <p>KubeMQ supports four messaging patterns</p> <ul><li>Events</li> <li>Events Store</li> <li>Commands</li> <li>Queries</li></ul> <h2 id="events">Events</h2> <p>‘Events’ is an asynchronous real-time Pub/Sub pattern.
In Events, multiple senders can send real-time messages to multiple receivers, however, only if they are currently connected to KubeMQ; there is no message persistence available in this pattern.</p> <p><strong>Use Cases</strong></p> <p>‘Events’ pattern is suitable for cases such as publishing streaming data, logs, notifications etc.</p> <h2 id="events-store">Events Store</h2> <p>‘Events Store’ is an asynchronous Pub/Sub pattern with persistence.
In Events Store, multiple senders can send messages to multiple receivers even if they are not currently. Any receiver can connect to KubeMQ and replay one, any, or all of the messages stored for specific channel.</p> <p>KubeMQ supports six types of Events Store subscriptions:</p> <table><thead><tr><th style="text-align:left">Type</th> <th style="text-align:left">Description</th></tr></thead> <tbody><tr><td style="text-align:left">New Events</td> <td style="text-align:left">KubeMQ will send only new events</td></tr> <tr><td style="text-align:left">First Event</td> <td style="text-align:left">KubeMQ will replay all events from the first stored events, as well as send new events</td></tr> <tr><td style="text-align:left">Last Event</td> <td style="text-align:left">KubeMQ will replay the last event and continue to send new events</td></tr> <tr><td style="text-align:left">From Sequence</td> <td style="text-align:left">KubeMQ will replay events from a specific sequence and continue to send new events</td></tr> <tr><td style="text-align:left">From Time</td> <td style="text-align:left">KubeMQ will replay events from specific time in the past and continue to send new events</td></tr> <tr><td style="text-align:left">From Time Delta</td> <td style="text-align:left">KubeMQ will replay events from specific delta of time back (i.e. 5 min back) and continue to send new events</td></tr></tbody></table> <p><strong>Unique Client ID</strong></p> <p>The uniqueness of a client ID is important when using Events Store.  At any given time, only one receiver can connect with a unique Client ID. If two receivers try to connect to KubeMQ with the same Client ID, one of them will be rejected.</p> <p><strong>Client ID and Subscription Types Relations</strong></p> <p>For each unique Client ID, KubeMQ saves the subscription type in which the client connected; messages can only be replayed once per Client ID and Subscription type.</p> <p>For example, Receiver with Client ID <code>client-foo-1</code> subscribes to a channel <code>foo.bar</code> in <code>First Event</code> mode. They will get all the messages stored in KubeMQ for <code>foo.bar</code> channel from the first message, and then continue to get new events as they come.
If this receiver will disconnect from KubeMQ and re-connect again with any subscription type, only new events in <code>foo.bar</code> will delivered for this specific receiver with Client ID <code>client-foo-1</code>.</p> <p>If a Receiver wishes to receive messages on <code>foo.bar</code> again, they should subscribe again with a different Client ID than <code>client-foo-1</code> such <code>client-foo-1-retry</code>.</p> <p><strong>Use Cases</strong></p> <p>Events Store pattern is suitable for cases in which events are important, such as worker’s pool, chats and inbox related applications.</p> <h2 id="commands">Commands</h2> <p>‘Commands’ is a synchronous two ways Pub/Sub (Request and Response) pattern for <a href="https://martinfowler.com/bliki/CQRS.html" target="_blank" rel="noopener noreferrer">CQRS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> types of system architecture.</p> <p>This pattern implements the ‘Command’ part of <a href="https://martinfowler.com/bliki/CQRS.html" target="_blank" rel="noopener noreferrer">CQRS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as follows:</p> <ol><li>A Sender will submit a request to a channel with a specific Timeout for getting a Response.</li> <li>A Receiver will subscribe to a Channel (and Group if needed), will receive the Sender request together with unique ‘ReplyTo’ channel address. This address is generated by KubeMQ.</li> <li>A Responder, which can be either the Receiver service or a different service, will process the request and respond only if the Request was successful or not. in case of unsuccessful response, the responder can add an ‘Error’ description into the response message.</li> <li>The Sender will get the response from the Responder.</li> <li>If no response will be received within the Timeout that was set by the the Request, an error message will be returned (‘Timeout’).</li></ol> <p><strong>Use Cases</strong></p> <p>Commands pattern is suitable for use cases, such as sending updates to a DB, WebHooks or any request without the need of response by a specific time.</p> <h2 id="queries">Queries</h2> <p>‘Queries’ is a synchronous two ways Pub/Sub (Request and Response) pattern for <a href="https://martinfowler.com/bliki/CQRS.html" target="_blank" rel="noopener noreferrer">CQRS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> types of system architecture.</p> <p>This pattern implements the Query part of <a href="https://martinfowler.com/bliki/CQRS.html" target="_blank" rel="noopener noreferrer">CQRS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> as follows:</p> <ol><li>A Sender will send a Request to a channel with specific set timeout for getting a Response.</li> <li>A Receiver will subscribe to a Channel (and Group if needed), will receive the Sender request together with unique ‘ReplyTo’ channel address. This address is generated by KubeMQ.</li> <li>A Responder, which can be either the Receiver service or a different service, will process the request and respond with the query results (data), along with the execution result and appropriate Error string in the event of unsuccessful query processing.</li> <li>The Sender will get the response from the Responder.</li> <li>If no response will be received within the timeout that was set by the the Request, an error will be returned (‘Timeout’).</li></ol> <p><strong>Caching</strong>
KubeMQ supports caching of query results as follows:</p> <ol><li>A Sender will send a Request to a channel with specific set timeout, Cache key (string) and Cache TTL (Time To Live) value in seconds for getting a Response.</li> <li>KubeMQ will attempt to get the response results from Cache base on the Cache key.</li> <li>If a Response is stored in Cache, then the sender will get the response from the Cache.</li> <li>If a Response is NOT stored in Cache, KubeMQ will send the Request to an available Receiver (as above).</li> <li>Once a valid response is received from a Responder, KubeMQ will store the Response in the Cache, along with the Cache key provided by the Sender, for the time set by Cache TTL.</li> <li>A new Request within the Cache TTL time-frame, and with the same Cache key, will get the same Response as stored in KubeMQ from the previous Sender Request.</li></ol> <p><strong>Use Cases</strong></p> <p>Queries pattern is suitable for use cases, primarily for database queries.</p> <h2 id="commands-vs-queries">Commands vs. Queries</h2> <p>Commands and Queries are very similar patterns, however, there are two differences:</p> <ol><li>Commands Response returns only if the Request is successful or not, while Query returns with data in the Response.</li> <li>Queries support Caching, while Commands does not.</li></ol></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">1/8/2019, 6:47:57 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/concepts-terminology.html" class="prev">
          Terminology
        </a></span> <span class="next"><a href="/concepts-endpoints.html">
          Endpoints
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.d314ca50.js" defer></script><script src="/assets/js/5.5dd74b51.js" defer></script>
  </body>
</html>
