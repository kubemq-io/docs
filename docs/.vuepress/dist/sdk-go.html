<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Go | KubeMQ Documentation</title>
    <meta name="description" content="Message broker  for containers and Kubernetes">
    <link>
  <undefined></undefined>
    
    <link rel="preload" href="/assets/css/0.styles.bae48cfa.css" as="style"><link rel="preload" href="/assets/js/app.249c87be.js" as="script"><link rel="preload" href="/assets/js/2.8570e526.js" as="script"><link rel="preload" href="/assets/js/18.0dfadd6c.js" as="script"><link rel="prefetch" href="/assets/js/10.76ab3afc.js"><link rel="prefetch" href="/assets/js/11.1554a3e8.js"><link rel="prefetch" href="/assets/js/12.1e3effe7.js"><link rel="prefetch" href="/assets/js/13.b121272b.js"><link rel="prefetch" href="/assets/js/14.9428db1f.js"><link rel="prefetch" href="/assets/js/15.9336a248.js"><link rel="prefetch" href="/assets/js/16.cae37f38.js"><link rel="prefetch" href="/assets/js/17.10e050de.js"><link rel="prefetch" href="/assets/js/19.4679e098.js"><link rel="prefetch" href="/assets/js/20.dcb43d96.js"><link rel="prefetch" href="/assets/js/21.fef9f333.js"><link rel="prefetch" href="/assets/js/22.6b2d98f3.js"><link rel="prefetch" href="/assets/js/23.a1d603fd.js"><link rel="prefetch" href="/assets/js/24.52d64fc9.js"><link rel="prefetch" href="/assets/js/25.6b9a96ab.js"><link rel="prefetch" href="/assets/js/3.e149a682.js"><link rel="prefetch" href="/assets/js/4.bcc69662.js"><link rel="prefetch" href="/assets/js/5.9ca85b3b.js"><link rel="prefetch" href="/assets/js/6.4a88b5b8.js"><link rel="prefetch" href="/assets/js/7.270fdcb0.js"><link rel="prefetch" href="/assets/js/8.e9e1f68b.js"><link rel="prefetch" href="/assets/js/9.b0bdc1cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bae48cfa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/kubemq-logo.png" alt="KubeMQ Documentation" class="logo"> <span class="site-name can-hide">KubeMQ Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Home</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Get Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tutorials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Reference</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sdk-net.html" class="sidebar-link">.NET</a></li><li><a href="/sdk-java.html" class="sidebar-link">Java</a></li><li><a href="/sdk-go.html" class="active sidebar-link">Go</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sdk-go.html#table-of-content" class="sidebar-link">Table of Content</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#core-concepts" class="sidebar-link">Core Concepts</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#connection" class="sidebar-link">Connection</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#events" class="sidebar-link">Events</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#events-store" class="sidebar-link">Events Store</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#commands" class="sidebar-link">Commands</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#queries" class="sidebar-link">Queries</a></li><li class="sidebar-sub-header"><a href="/sdk-go.html#examples" class="sidebar-link">Examples</a></li></ul></li><li><a href="/sdk-python.html" class="sidebar-link">Python</a></li><li><a href="/rest.html" class="sidebar-link">REST</a></li><li><a href="/examples.html" class="sidebar-link">Examples</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="go">Go</h1> <p>KubeMQ is an enterprise-grade message broker for containers, designed for any workload and architecture running in Kubernetes.
This library is Go implementation of KubeMQ client connection.</p> <h2 id="table-of-content">Table of Content</h2> <p></p><div class="table-of-contents"><ul><li><a href="#table-of-content">Table of Content</a></li><li><a href="#installation">Installation</a></li><li><a href="#core-concepts">Core Concepts</a></li><li><a href="#connection">Connection</a></li><li><a href="#events">Events</a><ul><li><a href="#sending-events">Sending Events</a></li><li><a href="#receiving-events">Receiving Events</a></li></ul></li><li><a href="#events-store">Events Store</a><ul><li><a href="#sending-events-store">Sending Events Store</a></li><li><a href="#receiving-events-store">Receiving Events Store</a></li></ul></li><li><a href="#commands">Commands</a><ul><li><a href="#concept">Concept</a></li><li><a href="#sending-command-requests">Sending Command Requests</a></li><li><a href="#receiving-commands-requests">Receiving Commands Requests</a></li><li><a href="#sending-a-command-response">Sending a Command Response</a></li></ul></li><li><a href="#queries">Queries</a><ul><li><a href="#concept">Concept</a></li><li><a href="#sending-query-requests">Sending Query Requests</a></li><li><a href="#receiving-query-requests">Receiving Query Requests</a></li><li><a href="#sending-a-query-response">Sending a Query Response</a></li></ul></li><li><a href="#examples">Examples</a></li></ul></div><p></p> <h2 id="installation">Installation</h2> <p><code>$ go get -u github.com/kubemq-io/kubemq-go</code></p> <h2 id="core-concepts">Core Concepts</h2> <p>KubeMQ messaging broker has 4 messaging patterns:</p> <ul><li>Events - real-time pub/sub pattern</li> <li>Events Store - pub/sub with persistence pattern</li> <li>Commands - the Command part of CQRS pattern, which sends commands with the response for executed or not (with proper error messaging)</li> <li>Queries - the Query part of CQRS pattern, which sends a query and gets a response with the relevant query result back</li></ul> <p>For each one of the patterns, we can distinguish between the senders and the receivers.</p> <p>For events and events store, the KubeMQ supports both RPC and upstream calls.</p> <p>the data model is almost identical between all the pattern with some data added related to the specific patter.</p> <p>The common part of all the patterns are:</p> <ul><li>Id - the sender can set the Id for each type of message, or the Id is automatically generated a UUID Id for him.</li> <li>Metadata - a string field that can hold any metadata related to the message</li> <li>Body - a Bytes array which holds the actual payload to be sent from the sender to the receiver</li></ul> <p>The KubeMQ core transport is based on gRPC, and the library is a wrapper around the client-side of gRPC complied protobuf hence leveraging the gRPC benefits and advantages.</p> <p>Before any transactions to be performed with KubeMQ server, the Client should connect and dial KubeMQ server and obtain Client connection.</p> <p>With the Client connection object, the user can perform all transactions to and from KubeMQ server.</p> <p>A Client connection object is thread-safe and can be shared between all process needed to communicate with KubeMQ.</p> <p><strong>IMPORTANT</strong> - it's the user responsibility to close the Client connection when no further communication with KubeMQ is needed.</p> <h2 id="connection">Connection</h2> <p>Connecting to KubeMQ server can be done like that:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancel</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
client<span class="token punctuation">,</span> err <span class="token operator">:=</span> kubemq<span class="token punctuation">.</span><span class="token function">NewClient</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span>
kubemq<span class="token punctuation">.</span><span class="token function">WithAddress</span><span class="token punctuation">(</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
kubemq<span class="token punctuation">.</span><span class="token function">WithClientId</span><span class="token punctuation">(</span><span class="token string">&quot;test-event-client-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">defer</span> Client<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>List of connection options:</p> <ul><li>WithAddress - set host and port address of KubeMQ server</li> <li>WithCredentials - set secured TLS credentials from the input certificate file for Client.</li> <li>WithToken - set KubeMQ token to be used for KubeMQ connection - not mandatory, only if enforced by the KubeMQ server</li> <li>WithClientId - set client id to be used in all functions call with this Client - mandatory</li> <li>WithReceiveBufferSize - set length of the buffered channel to be set in all subscriptions</li> <li>WithDefaultChannel - set default channel for any outbound requests</li> <li>WithDefaultCacheTTL - set default cache time to live for any query requests with any CacheKey set value</li> <li>WithTransportType - set client transport type, currently gRPC or Rest</li></ul> <h2 id="events">Events</h2> <h3 id="sending-events">Sending Events</h3> <h4 id="single-event">Single Event</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code>err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetId</span><span class="token punctuation">(</span><span class="token string">&quot;some-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending single event&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="stream-events">Stream Events</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code>eventStreamCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token operator">*</span>kubemq<span class="token punctuation">.</span>Event<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
errStreamCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">go</span> client<span class="token punctuation">.</span><span class="token function">StreamEvents</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> eventStreamCh<span class="token punctuation">,</span> errStreamCh<span class="token punctuation">)</span>
event <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetId</span><span class="token punctuation">(</span><span class="token string">&quot;some-event-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetChannel</span><span class="token punctuation">(</span><span class="token string">&quot;some_channel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending stream event&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errStreamCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
   <span class="token keyword">case</span> eventStreamCh <span class="token operator">&lt;-</span> event<span class="token punctuation">:</span>
      <span class="token keyword">return</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="receiving-events">Receiving Events</h3> <p>First you should subscribe to Events and get a channel:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>channelName <span class="token operator">:=</span> <span class="token string">&quot;testing_event_channel&quot;</span>
errCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
eventsCh<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">SubscribeToEvents</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> channelName<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errCh<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Then you can loop over the channel of events:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token keyword">case</span> event <span class="token operator">:=</span> <span class="token operator">&lt;-</span>eventsCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Event Received:\nEventID: %s\nChannel: %s\nMetadata: %s\nBody: %s\n&quot;</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> event<span class="token punctuation">.</span>Channel<span class="token punctuation">,</span> event<span class="token punctuation">.</span>Metadata<span class="token punctuation">,</span> event<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="events-store">Events Store</h2> <h3 id="sending-events-store">Sending Events Store</h3> <h4 id="single-event-to-store">Single Event to Store</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//sending 10 single events to store</span>
<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
   result<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">ES</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
       <span class="token function">SetId</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;event-store-%d&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetChannel</span><span class="token punctuation">(</span>channelName<span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending single event to store&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
   <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
         log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Sending event #%d: Result: %t&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> result<span class="token punctuation">.</span>Sent<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="stream-events-store">Stream Events Store</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// sending addtional events to store</span>
eventsStoreStreamCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token operator">*</span>kubemq<span class="token punctuation">.</span>EventStore<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
eventsStoreSResultCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token operator">*</span>kubemq<span class="token punctuation">.</span>EventStoreResult<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
errStreamCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">go</span> client<span class="token punctuation">.</span><span class="token function">StreamEventsStore</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> eventsStoreStreamCh<span class="token punctuation">,</span> eventsStoreSResultCh<span class="token punctuation">,</span> errStreamCh<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
    event <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">ES</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetId</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;event-store-%d&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetChannel</span><span class="token punctuation">(</span>channelName<span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending stream event to store&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    eventsStoreStreamCh <span class="token operator">&lt;-</span> event
    <span class="token keyword">select</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errStreamCh<span class="token punctuation">:</span>
          log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
          <span class="token keyword">return</span>
          <span class="token keyword">case</span> result <span class="token operator">:=</span> <span class="token operator">&lt;-</span>eventsStoreSResultCh<span class="token punctuation">:</span>
             log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Sending event #%d: Result: %t&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> result<span class="token punctuation">.</span>Sent<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="receiving-events-store">Receiving Events Store</h3> <p>First you should subscribe to Events Store and get a channel:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>eventsCh<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">SubscribeToEventsStore</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> channelName<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errCh<span class="token punctuation">,</span> kubemq<span class="token punctuation">.</span><span class="token function">StartFromFirstEvent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="subscription-options">Subscription Options</h4> <p>KubeMQ supports 6 types of subscriptions:</p> <ul><li>StartFromNewEvents - start event store subscription with only new events</li> <li>StartFromFirstEvent - replay all the stored events from the first available sequence and continue stream new events from this point</li> <li>StartFromLastEvent - replay the last event and continue stream new events from this point</li> <li>StartFromSequence - replay events from specific event sequence number and continue stream new events from this point</li> <li>StartFromTime - replay events from specific time continue stream new events from this point</li> <li>StartFromTimeDelta - replay events from specific current time - delta duration in seconds, continue stream new events from this point</li></ul> <p>Then you can loop over the channel of events:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token keyword">case</span> event <span class="token operator">:=</span> <span class="token operator">&lt;-</span>eventsCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Receive EventStore\nSequence: %d\nTime: %s\nBody: %s\n&quot;</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>Sequence<span class="token punctuation">,</span> event<span class="token punctuation">.</span>Timestamp<span class="token punctuation">,</span> event<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="commands">Commands</h2> <h3 id="concept">Concept</h3> <p>Commands implement synchronous messaging pattern which the sender send a request and wait for a specific amount of time to get a response.</p> <p>The response can be successful or not. This is the responsibility of the responder to return with the result of the command within the time the sender set in the request.</p> <h3 id="sending-command-requests">Sending Command Requests</h3> <p>In this example, the responder should send his response withing one second. Otherwise, an error will be return as timeout.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>response<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetId</span><span class="token punctuation">(</span><span class="token string">&quot;some-command-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetChannel</span><span class="token punctuation">(</span>channelName<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending command, please reply&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetTimeout</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="receiving-commands-requests">Receiving Commands Requests</h3> <p>First get a channel of commands:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>errCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
commandsCh<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">SubscribeToCommands</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> channelName<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errCh<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
      log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Then a loop over the channel will get the requests from the senders.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
   <span class="token keyword">case</span> command <span class="token operator">:=</span> <span class="token operator">&lt;-</span>commandsCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Command Received:\nId %s\nChannel: %s\nMetadata: %s\nBody: %s\n&quot;</span><span class="token punctuation">,</span> command<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> command<span class="token punctuation">.</span>Channel<span class="token punctuation">,</span> command<span class="token punctuation">.</span>Metadata<span class="token punctuation">,</span> command<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
   <span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="sending-a-command-response">Sending a Command Response</h3> <p>When sending a response, there are two essential things to remember:</p> <ul><li>Set the relevant requestId which you respond to</li> <li>Set the ResponseTo string to the value of the request ResponseTo field</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code>err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetRequestId</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetResponseTo</span><span class="token punctuation">(</span>command<span class="token punctuation">.</span>ResponseTo<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetExecutedAt</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="queries">Queries</h2> <h3 id="concept-2">Concept</h3> <p>Queries implement synchronous messaging pattern which the sender send a request and wait for a specific amount of time to get a response.</p> <p>The response must include metadata or body together with an indication of successful or not operation. This is the responsibility of the responder to return with the result of the query within the time the sender set in the request.</p> <h3 id="sending-query-requests">Sending Query Requests</h3> <p>In this example, the responder should send his response withing one second. Otherwise, an error will be return as timeout.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>response<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">Q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetId</span><span class="token punctuation">(</span><span class="token string">&quot;some-query-id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;some-metadata&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;hello kubemq - sending a query, please reply&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetTimeout</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="receiving-query-requests">Receiving Query Requests</h3> <p>First get a channel of queries:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>errCh <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
queriesCh<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">SubscribeToQueries</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> channelName<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errCh<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Then a loop over the channel will get the requests from the senders.</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
   <span class="token keyword">select</span> <span class="token punctuation">{</span>
   <span class="token keyword">case</span> err <span class="token operator">:=</span> <span class="token operator">&lt;-</span>errCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
   <span class="token keyword">case</span> query <span class="token operator">:=</span> <span class="token operator">&lt;-</span>queriesCh<span class="token punctuation">:</span>
      log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Query Received:\nId %s\nChannel: %s\nMetadata: %s\nBody: %s\n&quot;</span><span class="token punctuation">,</span> query<span class="token punctuation">.</span>Id<span class="token punctuation">,</span> query<span class="token punctuation">.</span>Channel<span class="token punctuation">,</span> query<span class="token punctuation">.</span>Metadata<span class="token punctuation">,</span> query<span class="token punctuation">.</span>Body<span class="token punctuation">)</span>
   <span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span>
       <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="sending-a-query-response">Sending a Query Response</h3> <p>When sending a response, there are two essential things to remember:</p> <ul><li>Set the relevant requestId which you respond to</li> <li>Set the ResponseTo string to the value of the request ResponseTo field</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code>err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token function">SetRequestId</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetResponseTo</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>ResponseTo<span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetExecutedAt</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;this is a response&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;got your query, you are good to go&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
   <span class="token function">Send</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
   
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
   log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="examples">Examples</h2> <p>Please find usage examples on the examples folders.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/19/2019, 7:29:43 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        
        <a href="/sdk-java.html" class="prev">
          Java
        </a></span> <span class="next"><a href="/sdk-python.html">
          Python
        </a>
        
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.249c87be.js" defer></script><script src="/assets/js/2.8570e526.js" defer></script><script src="/assets/js/18.0dfadd6c.js" defer></script>
  </body>
</html>
