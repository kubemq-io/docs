<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>.NET | KubeMQ Documentation</title>
    <meta name="description" content="Message broker  for containers and Kubernetes">
    <link>
  <undefined></undefined>
    
    <link rel="preload" href="/assets/css/0.styles.bae48cfa.css" as="style"><link rel="preload" href="/assets/js/app.249c87be.js" as="script"><link rel="preload" href="/assets/js/2.8570e526.js" as="script"><link rel="preload" href="/assets/js/20.dcb43d96.js" as="script"><link rel="prefetch" href="/assets/js/10.76ab3afc.js"><link rel="prefetch" href="/assets/js/11.1554a3e8.js"><link rel="prefetch" href="/assets/js/12.1e3effe7.js"><link rel="prefetch" href="/assets/js/13.b121272b.js"><link rel="prefetch" href="/assets/js/14.9428db1f.js"><link rel="prefetch" href="/assets/js/15.9336a248.js"><link rel="prefetch" href="/assets/js/16.cae37f38.js"><link rel="prefetch" href="/assets/js/17.10e050de.js"><link rel="prefetch" href="/assets/js/18.0dfadd6c.js"><link rel="prefetch" href="/assets/js/19.4679e098.js"><link rel="prefetch" href="/assets/js/21.fef9f333.js"><link rel="prefetch" href="/assets/js/22.6b2d98f3.js"><link rel="prefetch" href="/assets/js/23.a1d603fd.js"><link rel="prefetch" href="/assets/js/24.52d64fc9.js"><link rel="prefetch" href="/assets/js/25.6b9a96ab.js"><link rel="prefetch" href="/assets/js/3.e149a682.js"><link rel="prefetch" href="/assets/js/4.bcc69662.js"><link rel="prefetch" href="/assets/js/5.9ca85b3b.js"><link rel="prefetch" href="/assets/js/6.4a88b5b8.js"><link rel="prefetch" href="/assets/js/7.270fdcb0.js"><link rel="prefetch" href="/assets/js/8.e9e1f68b.js"><link rel="prefetch" href="/assets/js/9.b0bdc1cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bae48cfa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/kubemq-logo.png" alt="KubeMQ Documentation" class="logo"> <span class="site-name can-hide">KubeMQ Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://kubemq.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KubeMQ.io
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://account.kubemq.io/login/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Register
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Home</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Get Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Installation</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tutorials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Reference</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sdk-net.html" class="active sidebar-link">.NET</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sdk-net.html#table-of-content" class="sidebar-link">Table of Content</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#general-sdk-description" class="sidebar-link">General SDK description</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#installation" class="sidebar-link">Installation:</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#usage-main-concepts" class="sidebar-link">Usage: Main concepts</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#usage-event-eventstore" class="sidebar-link">Usage: Event\EventStore</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#usage-command-query" class="sidebar-link">Usage: Command\Query</a></li><li class="sidebar-sub-header"><a href="/sdk-net.html#usage-channel" class="sidebar-link">Usage: Channel</a></li></ul></li><li><a href="/sdk-java.html" class="sidebar-link">Java</a></li><li><a href="/sdk-go.html" class="sidebar-link">Go</a></li><li><a href="/sdk-python.html" class="sidebar-link">Python</a></li><li><a href="/rest.html" class="sidebar-link">REST</a></li><li><a href="/examples.html" class="sidebar-link">Examples</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="net">.NET</h1> <p>.NET client SDK for KubeMQ. Simple interface to work with the KubeMQ server.</p> <h2 id="table-of-content">Table of Content</h2> <p></p><div class="table-of-contents"><ul><li><a href="#table-of-content">Table of Content</a></li><li><a href="#general-sdk-description">General SDK description</a></li><li><a href="#installation">Installation:</a><ul><li><a href="#supports">Supports:</a></li></ul></li><li><a href="#configuration">Configuration</a><ul><li><a href="#configuration-via-environment-variable">Configuration via Environment Variable</a></li><li><a href="#configuration-via-appsettings-json">Configuration via appsettings.json</a></li><li><a href="#configuration-via-app-config">Configuration via app.Config</a></li><li><a href="#configuration-via-code">Configuration via code</a></li></ul></li><li><a href="#usage-main-concepts">Usage: Main concepts</a><ul><li><a href="#the-subscriberequest-object">The SubscribeRequest Object:</a></li></ul></li><li><a href="#usage-event-eventstore">Usage: Event\EventStore</a><ul><li><a href="#the-kubemq-sdk-csharp-events-lowlevel-event-object">The KubeMQ.SDK.csharp.Events.LowLevel.Event object:</a></li><li><a href="#the-eventsstoretype-object">The 'EventsStoreType' object:</a></li><li><a href="#method-subscribe">Method: Subscribe</a></li><li><a href="#method-send-single">Method: send single</a></li><li><a href="#method-send-stream">Method: send stream</a></li></ul></li><li><a href="#usage-command-query">Usage: Command\Query</a><ul><li><a href="#cache-mechanism">Cache mechanism</a></li><li><a href="#the-kubemq-sdk-csharp-commandquery-lowlevel-request-object">The KubeMQ.SDK.csharp.CommandQuery.LowLevel.Request object:</a></li><li><a href="#the-response-object">The Response object:</a></li><li><a href="#method-subscribe-to-requests">Method: Subscribe to requests</a></li><li><a href="#send-request-methods">Send request methods</a></li><li><a href="#method-send-request-async">Method: send request Async</a></li><li><a href="#method-send-request">Method: send request</a></li></ul></li><li><a href="#usage-channel">Usage: Channel</a><ul><li><a href="#kubemq-sdk-csharp-events-channel">KubeMQ.SDK.csharp.Events.Channel</a></li></ul></li></ul></div><p></p> <h2 id="general-sdk-description">General SDK description</h2> <p>The SDK implements all communication patterns available through the KubeMQ server:</p> <ul><li>Events</li> <li>EventStore</li> <li>Command</li> <li>Query</li></ul> <h2 id="installation">Installation:</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>  Install-Package KubeMQ.SDK.csharp -Version 1.0.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="supports">Supports:</h3> <ul><li>.NET Framework 4.6.1</li> <li>.NET Framework 4.7.1</li> <li>.NET Standard 2.0</li></ul> <h2 id="configuration">Configuration</h2> <p>The only required configuration setting is the KubeMQ server address.</p> <p>Configuration can be set by using one of the following:</p> <ul><li>Environment Variable</li> <li><code>appsettings.json</code> file</li> <li><code>app.Config</code> or <code>Web.config</code> file</li> <li>Within the code</li></ul> <h3 id="configuration-via-environment-variable">Configuration via Environment Variable</h3> <p>Set <code>KubeMQServerAddress</code> to the KubeMQ Server Address</p> <h3 id="configuration-via-appsettings-json">Configuration via appsettings.json</h3> <p>Simply add the following to your appsettings.json:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;KubeMQ&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;serverAddress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{YourServerAddress}:{YourServerPort}&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="configuration-via-app-config">Configuration via app.Config</h3> <p>Simply add the following to your app.config:</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>  
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configSections</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>KubeMQ<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>System.Configuration.NameValueSectionHandler<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>      
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configSections</span><span class="token punctuation">&gt;</span></span>  
    
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>KubeMQ</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>serverAddress<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>{YourServerAddress}:{YourServerPort}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>KubeMQ</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="configuration-via-code">Configuration via code</h3> <p>When setting the KubeMQ server address within the code, simply pass the address as a parameter to the various constructors.
See exactly how in the code examples in this document.</p> <h2 id="usage-main-concepts">Usage: Main concepts</h2> <ul><li><strong>Channel:</strong> Represents the endpoint target. One-to-one or one-to-many. Real-Time Multicast.</li> <li><strong>Group:</strong> Optional parameter when subscribing to a channel. A set of subscribers can define the same group so that only one of the subscribers within the group will receive a specific event. Used mainly for load balancing. Subscribing without the group parameter ensures receiving all the channel messages. (When using Grouping all the programs that are assigned to the group need to have to same channel name)</li> <li><strong>Metadata:</strong> The metadata allows us to pass additional information with the event. Can be in any form that can be presented as a string, i.e., struct, JSON, XML and many more.</li> <li><strong>Body:</strong> The actual content of the event. Can be in any form that is serializable into a byte array, i.e., string, struct, JSON, XML, Collection, binary file and many more.</li> <li><strong>ClientID:</strong>  Displayed in logs, tracing and KubeMQ dashboard(When using EventStore it must be unique).</li> <li><strong>Event Store:</strong> The Event Store represents a persistence storge, should be used when need to store data on a volume.</li></ul> <h3 id="the-subscriberequest-object">The SubscribeRequest Object:</h3> <p>A struct that is used to initialize SubscribeToEvents/SubscribeToRequest,
the SubscribeRequest contains the following:</p> <ul><li>SubscribeType - Mandatory -  Enum that represent the subscription type:
<ul><li>Events - if there is no need for Persistence.</li> <li>EventsStore - If you want to receive Events from persistence <a href="#usage-main-concepts">See Main concepts</a>.</li> <li>Command - Should be used when a response is not needed.</li> <li>Query - Should be used when a response is needed.</li></ul></li> <li>ClientID - Mandatory - <a href="#usage-main-concepts">See Main concepts</a></li> <li>Channel - Mandatory - <a href="#usage-main-concepts">See Main concepts</a></li> <li>Group - Optional - <a href="#usage-main-concepts">See Main concepts</a></li> <li>EventsStoreType - Mandatory - set the type event store to subscribe to <a href="#usage-main-concepts">Main concepts</a>.</li></ul> <h2 id="usage-event-eventstore">Usage: Event\EventStore</h2> <p>Employing several variations of point to point Event communication style patterns.
Allows to connect a sender to one or a group of subscribers</p> <ul><li>Subscribe to events</li> <li>Send stream</li> <li>Send single event</li></ul> <h3 id="the-kubemq-sdk-csharp-events-lowlevel-event-object">The <code>KubeMQ.SDK.csharp.Events.LowLevel.Event</code> object:</h3> <p>Struct used to send and receive Events using the Event pattern. Contains the following fields (See <a href="#usage-main-concepts">Main concepts</a> for more details on each field):</p> <ul><li>Channel</li> <li>Metadata</li> <li>Body</li> <li>EventID - set internally</li> <li>Store - Boolean, set if the event should be sent to store.</li> <li>ClientID</li></ul> <h3 id="the-eventsstoretype-object">The 'EventsStoreType' object:</h3> <p>To receive events from persistence, the subscriber need to assign one of seven EventsStoreType and the value for EventsStoreTypeValue.</p> <ul><li>EventsStoreTypeUndefined - 0 - Should be set when there is no need for eventsStore.(when using this type there is no need to            set EventsStoreTypeValue)</li> <li>StartNewOnly - 1 - The subscriber will only receive new events (from the time he subscribed).(when using this type there is              no need to set EventsStoreTypeValue)</li> <li>StartFromFirst - 2 - The subscriber will receive all events from the start of the queue and all future events as well.(when              using this type there is no need to set EventsStoreTypeValue)</li> <li>StartFromLast - 3 - The subscriber will receive the last event in queue and all future events as well.(when using this type              there is no need to set EventsStoreTypeValue)</li> <li>StartAtSequence - 4 - The subscriber will receive events from the chosen Sequence and all future events as well. (need to                provide with long that of the wanted eventID)</li> <li>StartAtTime - 5 - The subscriber will receive events that were &quot;Stored&quot; from a certain DateTime and all future events as well.            (need to provide with chosen time)</li> <li>StartAtTimeDelta - 6 - The subscriber will receive events that were &quot;Stored&quot; from the difference between DateTime.Now minus              the delta was chosen. (need to provide with a long that represents the time delta to check within milliseconds)</li></ul> <h3 id="method-subscribe">Method: Subscribe</h3> <p>This method allows subscribing to events. Both single and stream of events.
Pass a delegate (callback) that will handle the incoming event(s).
The implementation uses <code>await</code> and does not block the continuation of the code execution.</p> <p><strong>Parameters</strong>:</p> <ul><li>SubscribeRequest - Mandatory-<a href="#the-subscriberequest-object">See SubscribeRequest</a>.</li> <li>Handler - Mandatory. Delegate (callback) that will handle the incoming events.</li></ul> <p>Initialize <code>Subscriber</code> with server address from code:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> serverAddress <span class="token operator">=</span> <span class="token string">&quot;localhost:50000&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Subscriber</span> subscriber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span>serverAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Initialize <code>Subscriber</code> with server address set in configuration:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">Subscriber</span> subscriber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subscriber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Subscribe:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> channel <span class="token operator">=</span> <span class="token string">&quot;Sample.test1&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// Set a SubscribeRequest without Store and with Group.</span>
<span class="token class-name">SubscribeRequest</span> subscribeRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscribeRequest</span><span class="token punctuation">(</span>SubscribeType<span class="token punctuation">.</span>Events<span class="token punctuation">,</span> <span class="token string">&quot;MyClientID&quot;</span><span class="token punctuation">,</span> channel<span class="token punctuation">,</span> EventsStoreType<span class="token punctuation">.</span>Undefined<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;MyGroup&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
subscriber<span class="token punctuation">.</span><span class="token function">SubscribeToEvents</span><span class="token punctuation">(</span>subscribeRequest<span class="token punctuation">,</span>HandleIncomingEvents<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// delegate to handle the incoming events</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">HandleIncomingEvents</span><span class="token punctuation">(</span>EventReceive @<span class="token keyword">event</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="method-send-single">Method: send single</h3> <p>This method allows for sending a single event.</p> <p><strong>parameters</strong>:</p> <ul><li>KubeMQ.SDK.csharp.Events.LowLevel.Event - Mandatory. The actual Event that will be sent.</li></ul> <p>Initialize <code>Sender</code> with server address from code (also can be initialized using config file):</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code> <span class="token keyword">string</span> serverAddress <span class="token operator">=</span> <span class="token string">&quot;localhost:50000&quot;</span><span class="token punctuation">;</span>
 <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Sender</span> sender <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Sender</span><span class="token punctuation">(</span>serverAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">// Create the Event</span>
KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Event @<span class="token keyword">event</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Channel <span class="token operator">=</span> <span class="token string">&quot;Sample.test1&quot;</span><span class="token punctuation">,</span>
    Metadata <span class="token operator">=</span> <span class="token string">&quot;A sample string Metadata&quot;</span><span class="token punctuation">,</span>
    Body <span class="token operator">=</span> Tools<span class="token punctuation">.</span>Converter<span class="token punctuation">.</span><span class="token function">ToByteArray</span><span class="token punctuation">(</span><span class="token string">&quot;Pubsub test Event&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    ClientID<span class="token operator">=</span><span class="token string">&quot;MyID&quot;</span><span class="token punctuation">,</span>
    Store<span class="token operator">=</span><span class="token keyword">false</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// SendEvent</span>
sender<span class="token punctuation">.</span><span class="token function">SendEvent</span><span class="token punctuation">(</span>@<span class="token keyword">event</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="method-send-stream">Method: send stream</h3> <p>This method allows for sending a stream of events.
Use cases: sending a file in multiple packets; frequent high rate of events.</p> <p>Initialize <code>Sender</code> with server address from code (also can be initialized using config file):</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> serverAddress <span class="token operator">=</span> <span class="token string">&quot;localhost:50000&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Sender</span> sender <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sender</span><span class="token punctuation">(</span>serverAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>

KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Event @<span class="token keyword">event</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">11</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">event</span> <span class="token operator">=</span> <span class="token function">CreateSimpleStringEvent</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    sender<span class="token punctuation">.</span><span class="token function">StreamEvent</span><span class="token punctuation">(</span>@<span class="token keyword">event</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Thread<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
sender<span class="token punctuation">.</span><span class="token function">ClosesEventStreamAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

 
<span class="token keyword">private</span> <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Event</span> <span class="token function">CreateSimpleStringEvent</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Channel <span class="token operator">=</span> <span class="token string">&quot;Sample.test1&quot;</span><span class="token punctuation">,</span>
        Metadata <span class="token operator">=</span> <span class="token string">&quot;A sample string Metadata&quot;</span><span class="token punctuation">,</span>
        Body <span class="token operator">=</span> Tools<span class="token punctuation">.</span>Converter<span class="token punctuation">.</span><span class="token function">ToByteArray</span><span class="token punctuation">(</span><span class="token string">&quot;Pubsub test event &quot;</span><span class="token operator">+</span> i<span class="token punctuation">)</span>
        ClientID<span class="token operator">=</span><span class="token string">&quot;MyID&quot;</span><span class="token punctuation">,</span>
        Store<span class="token operator">=</span><span class="token keyword">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="usage-command-query">Usage: Command\Query</h2> <p>Request\Reply communication pattern. Allows caching the response at the KubeMQ server.</p> <ul><li>Subscribe to requests</li> <li>Send request</li></ul> <h3 id="cache-mechanism">Cache mechanism</h3> <p>KubeMQ server allows storing each response in a dedicated cache system. Each request can specify whether or not to use the cache.
In case the cache is used, the KubeMQ server will try to return the response directly from the cache and reduce latency.</p> <p>To use the cache mechanism, add the following parameters to each <code>Request</code>:</p> <ul><li>CacheKey - Unique key to store the response in the KubeMQ cache mechanism.</li> <li>CacheTTL - Cache data Time to live in milliseconds per CacheKey.</li></ul> <p>In the <code>Response</code> object you will receive an indication whether it was returned from cache:</p> <ul><li>CacheHit - Indication if the response was returned from KubeMQ cache.</li></ul> <h3 id="the-kubemq-sdk-csharp-commandquery-lowlevel-request-object">The <code>KubeMQ.SDK.csharp.CommandQuery.LowLevel.Request</code> object:</h3> <p>Struct used to send the request under the Request\Reply pattern. Contains the following fields (See Main concepts for more details on some field):</p> <ul><li>RequestID - Optional. Used to match Request to Response. If omitted, it will be set internally.</li> <li>RequestType - Mandatory. Used to set if a response is expected or not.</li> <li>ClientID - Mandatory. Displayed in logs, tracing, and KubeMQ dashboard.</li> <li>Channel - Mandatory. The channel that the <code>Responder</code> subscribed on.</li> <li>Metadata - Mandatory.</li> <li>ReplyChannel - Read-only, set internally.</li> <li>Timeout - Mandatory. Max time for the response to return. Set per request. If exceeded an exception is thrown.</li> <li>CacheKey - Optional.</li> <li>CacheTTL - Optional.</li></ul> <h3 id="the-response-object">The <code>Response</code> object:</h3> <p>Struct used to send the response under the Request\Reply pattern.</p> <p>The <code>Response</code> Constructors requires the corresponding 'Request' object.</p> <p>Contains the following fields (See Main concepts for more details on some field):</p> <ul><li>ClientID - Mandatory. Represents the sender ID the response was sent from.</li> <li>RequestID - Set internally, used to match Request to Response.</li> <li>CacheHit - Set internally, indication if the response was returned from KubeMQ cache.</li> <li>ReplyChannel - Set internally, an indication the channel to send him the response.</li> <li>Metadata - Mandatory.</li> <li>Body - Mandatory.</li> <li>Timestamp -Set Internally, an indication of the time the response was created.</li> <li>Executed - Boolean that represents of the task the Responder was performed.</li> <li>Error - Mandatory - Represents if an error occurred while processing the request.</li></ul> <h3 id="method-subscribe-to-requests">Method: Subscribe to requests</h3> <p>This method allows subscribing to receive requests.</p> <p><strong>parameters</strong>:</p> <ul><li>SubscribeRequest - Mandatory-<a href="#the-subscriberequest-object">See SubscribeRequest</a>.</li> <li>Handler - Mandatory. Delegate (callback) that will handle the incoming requests.</li></ul> <p>Initialize <code>Responder</code> with server address from code:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> serverAddress <span class="token operator">=</span> <span class="token string">&quot;localhost:50000&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Responder</span> responder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Responder</span><span class="token punctuation">(</span>serverAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Initialize <code>Responder</code> with server address set in configuration:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">Responder</span> responder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Responder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Subscribe</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> channel <span class="token operator">=</span> <span class="token string">&quot;MyChannel.SimpleRequest&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//Subscribe to request expecting to send a response(Queries) and no group.</span>
<span class="token class-name">SubscribeRequest</span> subscribeRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubscribeRequest</span><span class="token punctuation">(</span>SubscribeType<span class="token punctuation">.</span>Queries<span class="token punctuation">,</span> <span class="token string">&quot;MyClientID&quot;</span><span class="token punctuation">,</span> channel<span class="token punctuation">,</span> EventsStoreType<span class="token punctuation">.</span>Undefined<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
responder<span class="token punctuation">.</span><span class="token function">SubscribeToRequests</span><span class="token punctuation">(</span>subscribeRequest<span class="token punctuation">,</span>HandleIncomingRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Handle requests and return responses</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// delegate to handle the incoming requests</span>
<span class="token keyword">private</span> <span class="token class-name">Response</span> <span class="token function">HandleIncomingRequests</span><span class="token punctuation">(</span><span class="token class-name">Request</span> request<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Convert the request Body to a string</span>
    <span class="token keyword">string</span> strBody <span class="token operator">=</span> Tools<span class="token punctuation">.</span>Converter<span class="token punctuation">.</span><span class="token function">FromByteArray</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>Body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">LogDebug</span><span class="token punctuation">(</span>$<span class="token string">&quot;Respond to Request. ID:'{request.ID}', Channel:'{request.Channel}', Body:'{strBody}'&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Create the Response object</span>
    <span class="token class-name">Response</span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
          Body <span class="token operator">=</span> Converter<span class="token punctuation">.</span><span class="token function">ToByteArray</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          Error <span class="token operator">=</span> <span class="token string">&quot;None&quot;</span><span class="token punctuation">,</span>
          ClientID <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ClientID<span class="token punctuation">,</span>
          Executed <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
          Metadata <span class="token operator">=</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> response<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="send-request-methods">Send request methods</h3> <p>The KubeMQ SDK comes with two similar methods to send a <code>Request</code> and wait for the <code>Response</code></p> <ul><li><code>SendRequestAsync</code> returns the <code>Response</code> in a Task</li> <li><code>SendRequest</code> returns the <code>Response</code> to the Delegate (callback) supplied as a parameter</li></ul> <h3 id="method-send-request-async">Method: send request Async</h3> <p>This method allows to send a request to the <code>Responder,</code> it awaits for the <code>Response</code> and returns it in a Task</p> <p><strong>parameters</strong>:</p> <ul><li>KubeMQ.SDK.csharp.CommandQuery.LowLevel.Request - Mandatory. The <code>Request</code> object to send.</li></ul> <p>Initialize <code>Initiator</code> with server address from code (also can be initialized using config file):</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">string</span> serverAddress <span class="token operator">=</span> <span class="token string">&quot;localhost:50000&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Initiator</span> initiator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Initiator</span><span class="token punctuation">(</span>serverAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Send Request and await for Response</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>CommandQuery<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>Request</span> request <span class="token operator">=</span> <span class="token class-name">KubeMQ<span class="token punctuation">.</span>SDK<span class="token punctuation">.</span>csharp<span class="token punctuation">.</span>CommandQuery<span class="token punctuation">.</span>LowLevel<span class="token punctuation">.</span>new</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Channel <span class="token operator">=</span> <span class="token string">&quot;MyChannel.SimpleRequest&quot;</span><span class="token punctuation">,</span>
                Metadata <span class="token operator">=</span> <span class="token string">&quot;MyMetadata&quot;</span><span class="token punctuation">,</span>
                Body <span class="token operator">=</span> Tools<span class="token punctuation">.</span>Converter<span class="token punctuation">.</span><span class="token function">ToByteArray</span><span class="token punctuation">(</span><span class="token string">&quot;A Simple Request.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                Timeout <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>
                CacheKey <span class="token operator">=</span> <span class="token string">&quot;Simple.CacheKey&quot;</span><span class="token punctuation">,</span>
                CacheTTL <span class="token operator">=</span> <span class="token number">5000</span><span class="token punctuation">,</span>
                RequestType<span class="token operator">=</span>RequestType<span class="token punctuation">.</span>Query<span class="token punctuation">,</span>
                ClientID<span class="token operator">=</span><span class="token string">&quot;MyClientID&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            
<span class="token class-name">Response</span> response <span class="token operator">=</span> initiator<span class="token punctuation">.</span><span class="token function">SendRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//Async</span>
<span class="token class-name">Response</span> response <span class="token operator">=</span> <span class="token keyword">await</span> initiator<span class="token punctuation">.</span><span class="token function">SendRequestAsync</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="method-send-request">Method: send request</h3> <p>This method allows to send a request to the <code>Responder</code>, and returns the <code>Response</code> to the Delegate (callback) supplied as a parameter</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>initiator<span class="token punctuation">.</span><span class="token function">SendRequest</span><span class="token punctuation">(</span>HandleResponse<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Method to handle the responses</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleResponse</span><span class="token punctuation">(</span><span class="token class-name">Response</span> response<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="usage-channel">Usage: Channel</h2> <p>Creating a Sender\Initiator with a set of predefined parameters to prevent repetitive code.</p> <p>*Replaces the channel parameter in the &quot;low level&quot; Event/Request.</p> <h3 id="kubemq-sdk-csharp-events-channel">KubeMQ.SDK.csharp.Events.Channel</h3> <p>Represents a Sender with a set of predefined parameters.</p> <p><strong>parameters</strong>:</p> <ul><li>KubeMQ.SDK.csharp.Events.ChannelParameters - Mandatory. # .NET
.NET client SDK for KubeMQ. Simple interface to work with the KubeMQ server.</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/19/2019, 7:29:43 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        
        <a href="/tutorials-kubetools.html" class="prev">
          KubeTools (KubeMQ CLI)
        </a></span> <span class="next"><a href="/sdk-java.html">
          Java
        </a>
        
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.249c87be.js" defer></script><script src="/assets/js/2.8570e526.js" defer></script><script src="/assets/js/20.dcb43d96.js" defer></script>
  </body>
</html>
